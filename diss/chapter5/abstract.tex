\begin{abstract}
% The four-sentence technique: ``The first states the problem. The
% second states why the problem is a problem. The third is my
% startling sentence. The fourth states the implication of my
% startling sentence.''

Convergent replicated data types, or CvRDTs, are lattice-based data
structures for enforcing the eventual consistency of replicated
objects in a distributed system.  Although CvRDTs are provably
eventually consistent, queries of CvRDTs nevertheless allow
inconsistent intermediate states of replicas to be observed; and
although in practice, many systems allow a mix of eventually consistent and
strongly consistent queries, CvRDTs only support the former.  Taking
inspiration from our previous work on \emph{LVars} for deterministic
parallel programming, we show how to extend CvRDTs to support
deterministic, strongly consistent queries using a mechanism called
\emph{threshold queries}.  The threshold query technique generalizes
to any lattice, and hence any CvRDT, and allows deterministic
observations to be made of replicated objects before the replicas'
states have converged.

%% Convergent replicated data types (CvRDTs) are a mechanism for ensuring
%% the eventual consistency of replicated objects in a distributed
%% system.  A CvRDT is a distributed, replicated data structure in which
%% the states a replica can take on are elements of a lattice, updates
%% can only change a replica's state in a way that is inflationary with
%% respect to the lattice, and replicas can merge with remote replicas by
%% taking the least upper bound of the two replicas' states according to
%% the lattice.  Although CvRDTs are provably eventually consistent,
%% ordinary queries of CvRDTs nevertheless allow inconsistent
%% intermediate states of replicas to be observed.

%% Borrowing from our previous work on \emph{LVars} for deterministic
%% parallel programming, we propose \emph{threshold queries}, a way of
%% reading the contents of a CvRDT data structure that, rather than
%% returning its exact, complete contents, only reveals whether the
%% contents have crossed a given ``threshold'' in the lattice.  A
%% threshold query blocks until the threshold is reached and then returns
%% a deterministic result.

%% In this paper, we show how to extend CvRDTs with support for threshold
%% queries.  We prove that, assuming eventual delivery of updates at all
%% replicas, a threshold query that returns a particular answer is
%% guaranteed to return the same answer on subsequent queries of that
%% replica, regardless of the replica's state.  Moreover, executions of
%% the same query on other replicas are guaranteed to eventually return
%% the same answer, and to block until they do so.  The threshold query
%% technique generalizes to any lattice, and hence any CvRDT, and allows
%% deterministic observations to be made of replicated objects before the
%% replicas' states have converged.
\end{abstract}

